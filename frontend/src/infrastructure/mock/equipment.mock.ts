/**
 * Mock Data: Equipment (Inverters, Meters, Batteries)
 * Realistic equipment data for all sites
 */

import { Inverter, Meter, Battery, MPPTData } from '@/domain/entities/equipment.entity';

/**
 * Helper: Generate MPPT data for an inverter
 */
const generateMPPTData = (count: number, basePower: number): MPPTData[] => {
  return Array.from({ length: count }, (_, i) => {
    const powerVariation = 0.8 + Math.random() * 0.4; // 80-120% of base
    const voltage = 600 + Math.random() * 200; // 600-800V DC
    const power = (basePower / count) * powerVariation;
    const current = power * 1000 / voltage; // P = V * I
    
    return {
      id: i + 1,
      voltage: Number(voltage.toFixed(1)),
      current: Number(current.toFixed(2)),
      power: Number(power.toFixed(2)),
      status: Math.random() > 0.95 ? 'fault' : 'active',
    };
  });
};

/**
 * Mock Inverters
 */
export const mockInverters: Inverter[] = [
  // Chennai Technology Park - 6 inverters
  {
    id: 'inv-chn-01',
    siteId: 'site-1',
    name: 'Inverter 01 - Building A',
    model: 'Huawei SUN2000-100KTL-M1',
    serialNumber: 'HW-CHN-001',
    status: 'online',
    activePower: 85.5,
    efficiency: 97.2,
    temperature: 42,
    dailyYield: 245,
    totalYield: 125000,
    mpptCount: 10,
    mpptData: generateMPPTData(10, 85.5),
    gridVoltage: 415,
    gridFrequency: 50.02,
    gridCurrent: 118,
    lastCommunication: new Date(),
    communicationStatus: 'online',
    runningHours: 12500,
    alarms: [],
    faults: [],
    metadata: {
      manufacturer: 'Huawei',
      installationDate: new Date('2024-01-15'),
      location: 'Building A - Rooftop',
    },
  },
  {
    id: 'inv-chn-02',
    siteId: 'site-1',
    name: 'Inverter 02 - Building A',
    model: 'Huawei SUN2000-100KTL-M1',
    serialNumber: 'HW-CHN-002',
    status: 'online',
    activePower: 82.3,
    efficiency: 96.8,
    temperature: 44,
    dailyYield: 238,
    totalYield: 123000,
    mpptCount: 10,
    mpptData: generateMPPTData(10, 82.3),
    gridVoltage: 413,
    gridFrequency: 50.01,
    gridCurrent: 114,
    lastCommunication: new Date(),
    communicationStatus: 'online',
    runningHours: 12480,
    alarms: [],
    faults: [],
    metadata: {
      manufacturer: 'Huawei',
      installationDate: new Date('2024-01-15'),
      location: 'Building A - Rooftop',
    },
  },
  {
    id: 'inv-chn-03',
    siteId: 'site-1',
    name: 'Inverter 03 - Building B',
    model: 'Huawei SUN2000-100KTL-M1',
    serialNumber: 'HW-CHN-003',
    status: 'warning',
    activePower: 78.1,
    efficiency: 95.5,
    temperature: 48,
    dailyYield: 225,
    totalYield: 121000,
    mpptCount: 10,
    mpptData: generateMPPTData(10, 78.1),
    gridVoltage: 414,
    gridFrequency: 50.03,
    lastCommunication: new Date(),
    communicationStatus: 'online',
    runningHours: 12450,
    alarms: ['High temperature warning'],
    faults: [],
    metadata: {
      manufacturer: 'Huawei',
      installationDate: new Date('2024-01-15'),
      location: 'Building B - Rooftop',
    },
  },
  {
    id: 'inv-chn-04',
    siteId: 'site-1',
    name: 'Inverter 04 - Building B',
    model: 'Huawei SUN2000-100KTL-M1',
    serialNumber: 'HW-CHN-004',
    status: 'online',
    activePower: 88.2,
    efficiency: 97.5,
    temperature: 41,
    dailyYield: 252,
    totalYield: 126000,
    mpptCount: 10,
    mpptData: generateMPPTData(10, 88.2),
    gridVoltage: 416,
    gridFrequency: 50.02,
    lastCommunication: new Date(),
    communicationStatus: 'online',
    runningHours: 12520,
    alarms: [],
    faults: [],
    metadata: {
      manufacturer: 'Huawei',
      installationDate: new Date('2024-01-15'),
      location: 'Building B - Rooftop',
    },
  },
  
  // Bangalore Innovation Hub - 5 inverters
  {
    id: 'inv-blr-01',
    siteId: 'site-2',
    name: 'Inverter 01',
    model: 'SMA Sunny Tripower CORE1',
    serialNumber: 'SMA-BLR-001',
    status: 'online',
    activePower: 72.5,
    efficiency: 96.9,
    temperature: 39,
    dailyYield: 198,
    totalYield: 89000,
    mpptCount: 8,
    mpptData: generateMPPTData(8, 72.5),
    gridVoltage: 412,
    gridFrequency: 50.01,
    lastCommunication: new Date(),
    communicationStatus: 'online',
    runningHours: 9850,
    alarms: [],
    faults: [],
    metadata: {
      manufacturer: 'SMA',
      installationDate: new Date('2024-02-20'),
      location: 'Main Building - Rooftop',
    },
  },
  {
    id: 'inv-blr-02',
    siteId: 'site-2',
    name: 'Inverter 02',
    model: 'SMA Sunny Tripower CORE1',
    serialNumber: 'SMA-BLR-002',
    status: 'online',
    activePower: 74.8,
    efficiency: 97.1,
    temperature: 38,
    dailyYield: 205,
    totalYield: 91000,
    mpptCount: 8,
    mpptData: generateMPPTData(8, 74.8),
    gridVoltage: 413,
    gridFrequency: 50.02,
    lastCommunication: new Date(),
    communicationStatus: 'online',
    runningHours: 9880,
    alarms: [],
    faults: [],
    metadata: {
      manufacturer: 'SMA',
      installationDate: new Date('2024-02-20'),
      location: 'Main Building - Rooftop',
    },
  },
  
  // Hyderabad Data Center - 4 inverters
  {
    id: 'inv-hyd-01',
    siteId: 'site-3',
    name: 'Inverter 01',
    model: 'ABB PVS980',
    serialNumber: 'ABB-HYD-001',
    status: 'online',
    activePower: 62.3,
    efficiency: 96.5,
    temperature: 43,
    dailyYield: 172,
    totalYield: 78000,
    mpptCount: 12,
    mpptData: generateMPPTData(12, 62.3),
    gridVoltage: 411,
    gridFrequency: 50.00,
    lastCommunication: new Date(),
    communicationStatus: 'online',
    runningHours: 8520,
    alarms: [],
    faults: [],
    metadata: {
      manufacturer: 'ABB',
      installationDate: new Date('2024-03-15'),
      location: 'DC Building - Rooftop',
    },
  },
  {
    id: 'inv-hyd-02',
    siteId: 'site-3',
    name: 'Inverter 02',
    model: 'ABB PVS980',
    serialNumber: 'ABB-HYD-002',
    status: 'online',
    activePower: 58.7,
    efficiency: 96.2,
    temperature: 45,
    dailyYield: 165,
    totalYield: 76500,
    mpptCount: 12,
    mpptData: generateMPPTData(12, 58.7),
    gridVoltage: 412,
    gridFrequency: 50.01,
    lastCommunication: new Date(),
    communicationStatus: 'online',
    runningHours: 8490,
    alarms: [],
    faults: [],
    metadata: {
      manufacturer: 'ABB',
      installationDate: new Date('2024-03-15'),
      location: 'DC Building - Rooftop',
    },
  },
  
  // Mumbai Financial District - 4 inverters
  {
    id: 'inv-mum-01',
    siteId: 'site-4',
    name: 'Inverter 01',
    model: 'Delta M88H',
    serialNumber: 'DLTA-MUM-001',
    status: 'online',
    activePower: 68.5,
    efficiency: 97.0,
    temperature: 40,
    dailyYield: 185,
    totalYield: 72000,
    mpptCount: 9,
    mpptData: generateMPPTData(9, 68.5),
    gridVoltage: 415,
    gridFrequency: 50.02,
    lastCommunication: new Date(),
    communicationStatus: 'online',
    runningHours: 7800,
    alarms: [],
    faults: [],
    metadata: {
      manufacturer: 'Delta',
      installationDate: new Date('2024-04-25'),
      location: 'Tower A - Rooftop',
    },
  },
  
  // Ahmedabad Manufacturing - 6 inverters
  {
    id: 'inv-ahm-01',
    siteId: 'site-5',
    name: 'Inverter 01',
    model: 'Sungrow SG110CX',
    serialNumber: 'SG-AHM-001',
    status: 'online',
    activePower: 95.2,
    efficiency: 97.8,
    temperature: 44,
    dailyYield: 265,
    totalYield: 68000,
    mpptCount: 12,
    mpptData: generateMPPTData(12, 95.2),
    gridVoltage: 416,
    gridFrequency: 50.01,
    lastCommunication: new Date(),
    communicationStatus: 'online',
    runningHours: 7200,
    alarms: [],
    faults: [],
    metadata: {
      manufacturer: 'Sungrow',
      installationDate: new Date('2024-05-10'),
      location: 'Factory - Main Roof',
    },
  },
  {
    id: 'inv-ahm-02',
    siteId: 'site-5',
    name: 'Inverter 02',
    model: 'Sungrow SG110CX',
    serialNumber: 'SG-AHM-002',
    status: 'online',
    activePower: 92.8,
    efficiency: 97.5,
    temperature: 46,
    dailyYield: 258,
    totalYield: 66500,
    mpptCount: 12,
    mpptData: generateMPPTData(12, 92.8),
    gridVoltage: 414,
    gridFrequency: 50.00,
    lastCommunication: new Date(),
    communicationStatus: 'online',
    runningHours: 7150,
    alarms: [],
    faults: [],
    metadata: {
      manufacturer: 'Sungrow',
      installationDate: new Date('2024-05-10'),
      location: 'Factory - Main Roof',
    },
  },
];

/**
 * Mock Meters
 */
export const mockMeters: Meter[] = [
  // Chennai - Grid Meter
  {
    id: 'meter-chn-grid',
    siteId: 'site-1',
    type: 'grid',
    name: 'Grid Connection Meter',
    model: 'Schneider PM5560',
    serialNumber: 'SCH-CHN-G001',
    status: 'online',
    activePower: 125.5,
    reactivePower: 12.5,
    apparentPower: 126.1,
    powerFactor: 0.995,
    voltageL1: 415,
    voltageL2: 413,
    voltageL3: 416,
    voltageAvg: 414.7,
    currentL1: 105,
    currentL2: 102,
    currentL3: 108,
    currentAvg: 105,
    frequency: 50.02,
    energyImport: 1250000,
    energyExport: 485000,
    dailyImport: 1250,
    dailyExport: 620,
    lastCommunication: new Date(),
    communicationStatus: 'online',
    metadata: {
      manufacturer: 'Schneider Electric',
      installationDate: new Date('2024-01-10'),
      calibrationDate: new Date('2025-01-10'),
      location: 'Main Electrical Room',
    },
  },
  // Chennai - Load Meter
  {
    id: 'meter-chn-load',
    siteId: 'site-1',
    type: 'load',
    name: 'Campus Load Meter',
    model: 'Schneider PM5560',
    serialNumber: 'SCH-CHN-L001',
    status: 'online',
    activePower: 485.3,
    reactivePower: 45.2,
    apparentPower: 487.4,
    powerFactor: 0.996,
    voltageAvg: 415,
    currentAvg: 675,
    frequency: 50.02,
    energyImport: 2850000,
    dailyImport: 8520,
    lastCommunication: new Date(),
    communicationStatus: 'online',
    metadata: {
      manufacturer: 'Schneider Electric',
      installationDate: new Date('2024-01-10'),
      location: 'Main Distribution Panel',
    },
  },
  
  // Bangalore - Grid Meter
  {
    id: 'meter-blr-grid',
    siteId: 'site-2',
    type: 'grid',
    name: 'Grid Connection Meter',
    model: 'Siemens SENTRON PAC4200',
    serialNumber: 'SIE-BLR-G001',
    status: 'online',
    activePower: 98.2,
    powerFactor: 0.992,
    voltageAvg: 413,
    currentAvg: 137,
    frequency: 50.01,
    energyImport: 985000,
    energyExport: 325000,
    dailyImport: 950,
    dailyExport: 485,
    lastCommunication: new Date(),
    communicationStatus: 'online',
    metadata: {
      manufacturer: 'Siemens',
      installationDate: new Date('2024-02-15'),
      location: 'Electrical Room',
    },
  },
  
  // Hyderabad - Grid Meter
  {
    id: 'meter-hyd-grid',
    siteId: 'site-3',
    type: 'grid',
    name: 'Grid Connection Meter',
    model: 'ABB M2M',
    serialNumber: 'ABB-HYD-G001',
    status: 'online',
    activePower: 215.3,
    powerFactor: 0.998,
    voltageAvg: 411,
    currentAvg: 302,
    frequency: 50.00,
    energyImport: 1850000,
    energyExport: 125000,
    dailyImport: 5200,
    dailyExport: 280,
    lastCommunication: new Date(),
    communicationStatus: 'online',
    metadata: {
      manufacturer: 'ABB',
      installationDate: new Date('2024-03-10'),
      location: 'Main Switchgear Room',
    },
  },
  
  // Mumbai - Grid Meter
  {
    id: 'meter-mum-grid',
    siteId: 'site-4',
    type: 'grid',
    name: 'Grid Connection Meter',
    model: 'Schneider PM8000',
    serialNumber: 'SCH-MUM-G001',
    status: 'online',
    activePower: 142.5,
    powerFactor: 0.994,
    voltageAvg: 415,
    currentAvg: 198,
    frequency: 50.02,
    energyImport: 1150000,
    energyExport: 285000,
    dailyImport: 2850,
    dailyExport: 520,
    lastCommunication: new Date(),
    communicationStatus: 'online',
    metadata: {
      manufacturer: 'Schneider Electric',
      installationDate: new Date('2024-04-20'),
      location: 'Electrical Room - Level B2',
    },
  },
  
  // Ahmedabad - Grid Meter
  {
    id: 'meter-ahm-grid',
    siteId: 'site-5',
    type: 'grid',
    name: 'Grid Connection Meter',
    model: 'Siemens SENTRON PAC5200',
    serialNumber: 'SIE-AHM-G001',
    status: 'online',
    activePower: 285.7,
    powerFactor: 0.991,
    voltageAvg: 414,
    currentAvg: 398,
    frequency: 50.01,
    energyImport: 2150000,
    energyExport: 425000,
    dailyImport: 6200,
    dailyExport: 1150,
    lastCommunication: new Date(),
    communicationStatus: 'online',
    metadata: {
      manufacturer: 'Siemens',
      installationDate: new Date('2024-05-05'),
      location: 'Main Electrical House',
    },
  },
];

/**
 * Mock Batteries
 */
export const mockBatteries: Battery[] = [
  // Chennai - BESS
  {
    id: 'bat-chn-01',
    siteId: 'site-1',
    name: 'BESS Rack 01',
    model: 'BYD Battery-Box Premium HVS',
    serialNumber: 'BYD-CHN-001',
    status: 'online',
    soc: 72,
    soh: 98.5,
    activePower: 45.5, // charging
    maxChargePower: 100,
    maxDischargePower: 100,
    totalCapacity: 1200,
    availableCapacity: 1182,
    voltage: 768,
    current: 59.2,
    temperature: 28,
    temperatureMin: 26,
    temperatureMax: 30,
    cycleCount: 1250,
    dailyThroughput: 285,
    totalThroughput: 425000,
    cellCount: 240,
    cellVoltageMin: 3.198,
    cellVoltageMax: 3.205,
    cellVoltageDelta: 0.007,
    lastCommunication: new Date(),
    communicationStatus: 'online',
    alarms: [],
    metadata: {
      manufacturer: 'BYD',
      chemistry: 'LiFePO4',
      installationDate: new Date('2024-01-15'),
      rackLocation: 'Battery Room - Rack 1',
    },
  },
  
  // Bangalore - BESS
  {
    id: 'bat-blr-01',
    siteId: 'site-2',
    name: 'BESS Rack 01',
    model: 'Tesla Powerpack',
    serialNumber: 'TSLA-BLR-001',
    status: 'online',
    soc: 68,
    soh: 99.2,
    activePower: -38.2, // discharging
    maxChargePower: 125,
    maxDischargePower: 125,
    totalCapacity: 1000,
    availableCapacity: 992,
    voltage: 800,
    current: -47.8,
    temperature: 26,
    temperatureMin: 24,
    temperatureMax: 28,
    cycleCount: 980,
    dailyThroughput: 195,
    totalThroughput: 325000,
    cellCount: 320,
    cellVoltageMin: 2.498,
    cellVoltageMax: 2.503,
    cellVoltageDelta: 0.005,
    lastCommunication: new Date(),
    communicationStatus: 'online',
    alarms: [],
    metadata: {
      manufacturer: 'Tesla',
      chemistry: 'NMC',
      installationDate: new Date('2024-02-20'),
      rackLocation: 'Battery Container 1',
    },
  },
  
  // Hyderabad - BESS
  {
    id: 'bat-hyd-01',
    siteId: 'site-3',
    name: 'BESS Rack 01',
    model: 'LG Chem RESU',
    serialNumber: 'LG-HYD-001',
    status: 'warning',
    soc: 45,
    soh: 97.8,
    activePower: -52.1, // discharging
    maxChargePower: 100,
    maxDischargePower: 100,
    totalCapacity: 800,
    availableCapacity: 782,
    voltage: 750,
    current: -69.5,
    temperature: 32,
    temperatureMin: 30,
    temperatureMax: 35,
    cycleCount: 1580,
    dailyThroughput: 285,
    totalThroughput: 485000,
    cellCount: 192,
    cellVoltageMin: 3.895,
    cellVoltageMax: 3.908,
    cellVoltageDelta: 0.013,
    lastCommunication: new Date(),
    communicationStatus: 'online',
    alarms: ['SOC below 50%', 'Temperature above 30Â°C'],
    metadata: {
      manufacturer: 'LG Energy Solution',
      chemistry: 'NMC',
      installationDate: new Date('2024-03-15'),
      rackLocation: 'Battery Room - Rack 1',
    },
  },
  
  // Mumbai - BESS
  {
    id: 'bat-mum-01',
    siteId: 'site-4',
    name: 'BESS Rack 01',
    model: 'Samsung SDI ESS',
    serialNumber: 'SSDI-MUM-001',
    status: 'online',
    soc: 81,
    soh: 99.5,
    activePower: 35.2, // charging
    maxChargePower: 100,
    maxDischargePower: 100,
    totalCapacity: 900,
    availableCapacity: 895,
    voltage: 790,
    current: 44.6,
    temperature: 24,
    temperatureMin: 22,
    temperatureMax: 26,
    cycleCount: 820,
    dailyThroughput: 165,
    totalThroughput: 285000,
    cellCount: 256,
    cellVoltageMin: 3.082,
    cellVoltageMax: 3.087,
    cellVoltageDelta: 0.005,
    lastCommunication: new Date(),
    communicationStatus: 'online',
    alarms: [],
    metadata: {
      manufacturer: 'Samsung SDI',
      chemistry: 'NMC',
      installationDate: new Date('2024-04-25'),
      rackLocation: 'Battery Container - Level B1',
    },
  },
  
  // Ahmedabad - BESS
  {
    id: 'bat-ahm-01',
    siteId: 'site-5',
    name: 'BESS Rack 01',
    model: 'CATL EnerC',
    serialNumber: 'CATL-AHM-001',
    status: 'online',
    soc: 58,
    soh: 99.8,
    activePower: -28.5, // discharging
    maxChargePower: 150,
    maxDischargePower: 150,
    totalCapacity: 1500,
    availableCapacity: 1497,
    voltage: 820,
    current: -34.8,
    temperature: 27,
    temperatureMin: 25,
    temperatureMax: 29,
    cycleCount: 580,
    dailyThroughput: 225,
    totalThroughput: 195000,
    cellCount: 320,
    cellVoltageMin: 2.562,
    cellVoltageMax: 2.568,
    cellVoltageDelta: 0.006,
    lastCommunication: new Date(),
    communicationStatus: 'online',
    alarms: [],
    metadata: {
      manufacturer: 'CATL',
      chemistry: 'LiFePO4',
      installationDate: new Date('2024-05-10'),
      rackLocation: 'Battery Building - Container 1',
    },
  },
];

/**
 * Helper: Get equipment for a site
 */
export const getEquipmentForSite = (siteId: string) => ({
  inverters: mockInverters.filter(inv => inv.siteId === siteId),
  meters: mockMeters.filter(meter => meter.siteId === siteId),
  batteries: mockBatteries.filter(bat => bat.siteId === siteId),
});

/**
 * Helper: Get all equipment
 */
export const getAllEquipment = () => ({
  inverters: mockInverters,
  meters: mockMeters,
  batteries: mockBatteries,
});
